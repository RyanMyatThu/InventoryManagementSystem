@using System.Globalization

<div class="calendar-wrapper">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h5 class="card-title mb-0 fw-bold">@CurrentMonthName @CurrentDate.Year</h5>
        <div>
            <button class="btn btn-light btn-sm me-1" @onclick="PrevMonth">
                <i class="bi bi-chevron-left"></i>
            </button>
            <button class="btn btn-light btn-sm" @onclick="NextMonth">
                <i class="bi bi-chevron-right"></i>
            </button>
        </div>
    </div>

    <div class="calendar-grid calendar-header text-center fw-semibold text-muted mb-3">
        @foreach (var day in DayLabels)
        {
            <div class="calendar-day-label">@day</div>
        }
    </div>

    <div class="calendar-grid calendar-days text-center">
        @for (int i = 0; i < FirstDayOffset; i++)
        {
            <div class="calendar-empty"></div>
        }
        
        @for (int d = 1; d <= DaysInMonth; d++)
        {
            bool isToday =
            d == DateTime.Today.Day &&
            CurrentDate.Month == DateTime.Today.Month &&
            CurrentDate.Year == DateTime.Today.Year;

            <button class="calendar-day-btn @GetDayClass(isToday)">
                @d
            </button>
        }
    </div>
</div>

@code {
    private DateTime CurrentDate = DateTime.Today;

    private string[] DayLabels = new[] { "Su", "Mo", "Tu", "We", "Th", "Fr", "Sa" };
    private int DaysInMonth => DateTime.DaysInMonth(CurrentDate.Year, CurrentDate.Month);
    private int FirstDayOffset => (int)new DateTime(CurrentDate.Year, CurrentDate.Month, 1).DayOfWeek;
    private string CurrentMonthName => CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(CurrentDate.Month);

    private void PrevMonth() => CurrentDate = CurrentDate.AddMonths(-1);
    private void NextMonth() => CurrentDate = CurrentDate.AddMonths(1);

    private string GetDayClass(bool isToday) =>
        isToday ? "btn-primary text-white fw-semibold" : "btn-outline-light text-dark";
}
