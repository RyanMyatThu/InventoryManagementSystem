@using IMS.UseCases.CustomerPrices.Interfaces
@if(this.Item is not null){
    <tr>
        <td>
            <div class="d-flex align-items-center">
                <div class="rounded-circle bg-success bg-opacity-10 d-flex align-items-center justify-content-center me-3" style="width: 36px; height: 36px;">
                    <i class="bi bi-box-seam-fill text-success"></i>
                </div>
                <span class="fw-semibold">@Item.InventoryName</span>
            </div>
        </td>
        <td>
            <span class="fw-bold text-success">@Item.Price.ToString("N0")</span>
        </td>
        <td class="text-end">
            <div class="btn-group" role="group">
                <button type="button" class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#EditInventoryModal" @onclick="async () => {
                    await OnProductEdit.InvokeAsync(Item);
                }">
                    <i class="bi bi-pencil me-1"></i>Edit
                </button>
                <button type="button" class="btn btn-sm btn-outline-danger" @onclick="HandleDelete">
                    <i class="bi bi-trash me-1"></i>Delete
                </button>
            </div>
        </td>
    </tr>
}



@code {
    [Inject] IJSRuntime JSRuntime { get; set; } = default!;
    [Inject] IDeleteInventoryUseCase deleteInventoryUseCase { get; set; } = default!;
    [Inject] ICheckForInventoryItemUseCase checkForInventoryItemUseCase { get; set; } = default!;

    [Parameter]
    public Inventory? Item { get; set; }

    [Parameter]
    public EventCallback OnProductDelete { get; set; }

    [Parameter]
    public EventCallback<Inventory> OnProductEdit { get; set; }

    Inventory? currentEditItem;

    bool showEditModal;

    private async Task HandleDelete()
    {
        if (Item is not null)
        {
            var itemExists = await checkForInventoryItemUseCase.ExecuteAsync(Item.InventoryId);
            if (!itemExists)
            {
                await deleteInventoryUseCase.ExecuteAsync(Item.InventoryId);

                await OnProductDelete.InvokeAsync();
                await JSRuntime.InvokeVoidAsync("showDeleteSuccessful");
            } else
            {
                await JSRuntime.InvokeVoidAsync("alert", $"You must remove the item , {Item.InventoryName.Trim()} , from every customer purchasing it in order to remove it from the inventory.");
                return;
            }
        }

    }




   


}
